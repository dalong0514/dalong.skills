<!-- 此文件由机器翻译自 models-scrna-seq.md -->

# 单细胞 RNA-seq 模型

本文档涵盖了在 scvi 工具中分析单细胞 RNA 测序数据的核心模型。

## scVI（单细胞变分推理）

**目的**：scRNA-seq 数据的无监督分析、降维和批量校正。

**主要特点**：
- 基于变分自动编码器（VAE）的深度生成模型
- 学习捕获生物变异的低维潜在表示
- 自动纠正批次效应和技术协变量
- 实现标准化基因表达估计
- 支持差异表达分析

**何时使用**：
- scRNA-seq数据集的初步探索和降维
- 整合多个批次或研究
- 生成批量校正的表达矩阵
- 进行概率差异表达分析

**基本用法**：
```python
import scvi

# Setup data
scvi.model.SCVI.setup_anndata(
    adata,
    layer="counts",
    batch_key="batch"
)

# Train model
model = scvi.model.SCVI(adata, n_latent=30)
model.train()

# Extract results
latent = model.get_latent_representation()
normalized = model.get_normalized_expression()
```

**关键参数**：
- `n_latent`：潜在空间的维数（默认值：10）
- `n_layers`：隐藏层数（默认值：1）
- `n_hidden`：每个隐藏层的节点数（默认值：128）
- `dropout_rate`：神经网络的丢失率（默认值：0.1）
- `dispersion`：基因特异性或细胞特异性分散（“基因”或“基因批次”）
- `gene_likelihood`：数据分布（“zinb”、“nb”、“poisson”）

**输出**：
- `get_latent_representation()`：批量校正的低维嵌入
- `get_normalized_expression()`：去噪、归一化的表达值
- `differential_expression()`：组间概率 DE 测试
- `get_feature_correlation_matrix()`：基因-基因相关性估计

## scANVI（使用变分推理的单细胞注释）

**目的**：使用标记和未标记细胞进行半监督细胞类型注释和整合。

**主要特点**：
- 使用细胞类型标签扩展 scVI
- 利用部分标记的数据集进行注释传输
- 同时执行批量校正和细胞类型预测
- 启用查询到引用映射

**何时使用**：
- 使用参考标签注释新数据集
- 从注释良好的数据集到未标记的数据集的迁移学习
- 标记和未标记细胞的联合分析
- 构建具有不确定性量化的细胞类型分类器

**基本用法**：
<<<代码块_1>>>

**关键参数**：
- `labels_key`：`adata.obs`中包含单元格类型标签的列
- `unlabeled_category`：没有注释的单元格标签
- 所有 scVI 参数也可用

**输出**：
- `predict()`：所有单元格的单元格类型预测
- `predict_proba()`：预测概率
- `get_latent_representation()`：细胞类型感知的潜在空间

## 奥托兹

**目的**：scRNA-seq 数据中零膨胀基因的自动识别和建模。

**主要特点**：
- 区分生物零点和技术辍学
- 了解哪些基因表现出零通货膨胀
- 提供基因特定的零膨胀概率
- 通过考虑丢失来改进下游分析

**何时使用**：
- 检测哪些基因受到技术退出的影响
- 改进稀疏数据集的插补和标准化
- 了解数据中零通胀的程度

**基本用法**：
<<<代码块_2>>>

## 维洛VI

**目的**：使用变分推理进行 RNA 速度分析。

**主要特点**：
- 剪接和未剪接 RNA 计数的联合建模
- RNA 速度的概率估计
- 考虑技术噪音和批次效应
- 为速度估计提供不确定性量化

**何时使用**：
- 推断细胞动力学和分化轨迹
- 分析拼接/未拼接计数数据
- 带批量校正的 RNA 速度分析

**基本用法**：
<<<代码块_3>>>

## 对比VI

**目的**：从背景生物变异中分离出扰动特异性变异。

**主要特点**：
- 将共享变异（跨条件下常见）与目标特定变异分开
- 可用于扰动研究（药物治疗、遗传扰动）
- 识别特定条件的基因程序
- 能够发现特定治疗效果

**何时使用**：
- 分析微扰实验（药物筛选、CRISPR 等）
- 识别对治疗有特异性反应的基因
- 将治疗效果与背景变化分开
- 比较控制与扰动条件

**基本用法**：
<<<代码块_4>>>

## 单元格分配

**目的**：使用已知标记基因进行基于标记的细胞类型注释。

**主要特点**：
- 使用细胞类型标记基因的先验知识
- 细胞类型的概率分配
- 处理标记基因重叠和歧义
- 提供具有不确定性的软作业

**何时使用**：
- 使用已知的标记基因注释细胞
- 利用现有的生物学知识进行分类
- 标记基因列表可用但参考数据集不可用的情况

**基本用法**：
<<<代码块_5>>>

## Solo（双重检测）

**目的**：识别 scRNA-seq 数据中的双联体（包含两个或多个细胞的细胞）。

**主要特点**：
- 使用 scVI 嵌入进行半监督双峰检测
- 模拟人工双峰进行训练
- 提供双峰概率分数
- 可应用于任何scVI模型

**何时使用**：
- scRNA-seq数据集的质量控制
- 在下游分析之前去除双峰
- 评估数据中的双峰率

**基本用法**：
<<<代码块_6>>>

## 摊销LDA（主题建模）

**目的**：使用潜在狄利克雷分配进行基因表达主题建模。

**主要特点**：
- 发现基因表达程序（主题）
- 摊销变分推理以实现可扩展性
- 每个单元格都是主题的混合体
- 每个主题都是基因的分布

**何时使用**：
- 发现基因程序或表达模块
- 理解表达的构成结构
- 替代降维方法
- 表达模式的可解释分解

**基本用法**：
```python
scvi.model.AMORTIZEDLDA.setup_anndata(adata, layer="counts")
model = scvi.model.AMORTIZEDLDA(adata, n_topics=10)
model.train()

# Get topic compositions per cell
topic_proportions = model.get_latent_representation()

# Get gene loadings per topic
topic_gene_loadings = model.get_topic_distribution()
```

## 型号选择指南

**选择 scVI 时**：
- 从无监督分析开始
- 需要批量修正和集成
- 想要标准化表达和DE分析

**选择 scANVI 时**：
- 有一些标记的细胞用于训练
- 需要细胞类型注释
- 想要将标签从引用转移到查询

**选择 AUTOZI 时**：
- 担心技术性辍学
- 需要识别零膨胀基因
- 处理非常稀疏的数据集

**在以下情况下选择 VeloVI**：
- 有拼接/未拼接计数数据
- 对细胞动力学感兴趣
- 需要带有批量校正的 RNA 速度

**选择对比VI时**：
- 分析扰动实验
- 需要分离治疗效果
- 想要确定针对具体情况的计划

**在以下情况下选择 CellAssign：
- 有可用的标记基因列表
- 想要基于概率标记的注释
- 没有可用的参考数据集

**在以下情况下选择“独奏”**：
- 需要双峰检测
- 已使用 scVI 进行分析
- 想要概率双峰分数