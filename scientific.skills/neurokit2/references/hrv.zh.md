<!-- 此文件由机器翻译自 hrv.md -->

# 心率变异性 (HRV) 分析

## 概述

心率变异性 (HRV) 反映了连续心跳之间时间间隔的变化，可深入了解自主神经系统调节、心血管健康和心理状态。 NeuroKit2 提供跨时间、频率和非线性域的全面 HRV 分析。

## 主要功能

### hrv()

一次性计算所有域中所有可用的 HRV 指数。

```python
hrv_indices = nk.hrv(peaks, sampling_rate=1000, show=False)
```

**输入：**
- `peaks`：具有 `'ECG_R_Peaks'` 键或 R 峰值索引数组的字典
- `sampling_rate`：信号采样率（以 Hz 为单位）

**退货：**
- 包含来自所有领域的 HRV 指数的 DataFrame：
  - 时域指标
  - 频域功率谱
  - 非线性复杂度测量

**这是一个方便的包装**，它结合了：
- `hrv_time()`
- `hrv_frequency()`
- `hrv_nonlinear()`

## 时域分析

### hrv_time()

根据心跳间间隔 (IBI) 计算时域 HRV 指标。

<<<代码块_1>>>

### 关键指标

**基本区间统计：**
- `HRV_MeanNN`：NN 间隔的平均值（毫秒）
- `HRV_SDNN`：NN间隔的标准偏差（毫秒）
  - 反映总 HRV，捕获所有循环分量
  - 短期需要≥5分钟，长期需要≥24小时
- `HRV_RMSSD`：连续差值的均方根（毫秒）
  - 高频变异性，反映副交感神经活动
  - 录音更短更稳定

**连续差异测量：**
- `HRV_SDSD`：连续差异的标准偏差（毫秒）
  - 与 RMSSD 类似，与副交感神经活动相关
- `HRV_pNN50`：连续 NN 间隔相差 >50ms 的百分比
  - 副交感神经指标，在某些人群中可能不敏感
- `HRV_pNN20`：连续 NN 间隔相差 >20ms 的百分比
  - pNN50 的更灵敏替代品

**测量范围：**
- `HRV_MinNN`、`HRV_MaxNN`：最小和最大 NN 间隔（毫秒）
- `HRV_CVNN`：变异系数 (SDNN/MeanNN)
  - 标准化测量，可用于跨主题比较
- `HRV_CVSD`：连续差异的变异系数 (RMSSD/MeanNN)

**基于中位数的统计数据：**
- `HRV_MedianNN`：中值 NN 间隔（毫秒）
  - 对异常值具有鲁棒性
- `HRV_MadNN`：NN间隔的中值绝对偏差
  - 强大的分散措施
- `HRV_MCVNN`：基于中位数的变异系数

**高级时域：**
- `HRV_IQRNN`：NN 间隔的四分位数范围
- `HRV_pNN10`、`HRV_pNN25`、`HRV_pNN40`：附加百分位阈值
- `HRV_TINN`：NN区间直方图的三角插值
- `HRV_HTI`：HRV 三角索引（总 NN 间隔/直方图高度）

### 录音时长要求
- **超短（< 5 分钟）**：RMSSD、pNN50 最可靠
- **短期（5 分钟）**：临床使用标准，所有时域有效
- **长期（24 小时）**：SDNN 解释所需，捕获昼夜节律

## 频域分析

### hrv_频率()

使用频谱分析来分析跨频段的 HRV 功率。

<<<代码块_2>>>

### 频段

**超低频 (ULF)：0-0.0033 Hz**
- 需要≥24小时录音
- 昼夜节律、体温调节
- 新陈代谢过程缓慢

**甚低频 (VLF)：0.0033-0.04 Hz**
- 需要≥5分钟的录音
- 体温调节、荷尔蒙波动
- 肾素-血管紧张素系统，外周血管舒缩活性

**低频 (LF)：0.04-0.15 Hz**
- 交感神经和副交感神经的混合影响
- 压力感受器反射活动
- 血压调节（10秒节奏）

**高频 (HF)：0.15-0.4 Hz**
- 副交感神经（迷走神经）活动
- 呼吸性窦性心律失常
- 与呼吸同步（呼吸频率范围）

**甚高频 (VHF)：0.4-0.5 Hz**
- 很少使用，可能反映测量噪声
- 需要仔细解释

### 关键指标

**绝对功率（ms²）：**
- `HRV_ULF`、`HRV_VLF`、`HRV_LF`、`HRV_HF`、`HRV_VHF`：每个频段的功率
- `HRV_TP`：总功效（NN间隔的方差）
- `HRV_LFHF`：低频/高频比率（交感迷走神经平衡）

**归一化功率：**
- `HRV_LFn`：低频功率 / (LF + HF) - 归一化低频
- `HRV_HFn`：高频功率 / (LF + HF) - 归一化高频
- `HRV_LnHF`：HF 的自然对数（对数正态分布）

**峰值频率：**
- `HRV_LFpeak`、`HRV_HFpeak`：各频段最大功率频率
- 对于识别主导振荡很有用

### 功率谱密度方法

**韦尔奇方法（默认）：**
<<<代码块_3>>>
- 带重叠的加窗 FFT
- 光谱更平滑，方差减少
- 适合标准 HRV 分析

**Lomb-Scargle 周期图：**
<<<代码块_4>>>
- 处理不均匀采样的数据
- 无需插值
- 更适合嘈杂或包含工件的数据

**多锥度法：**
<<<代码块_5>>>
- 卓越的光谱估计
- 以最小的偏差减少方差
- 计算密集型

**伯格自回归：**
<<<代码块_6>>>
- 参数法
- 光谱平滑，峰值清晰
- 需要选择订单

### 解释指南

**低频/高频比率：**
- 传统上解释为交感迷走神经平衡
- **警告**：最近的证据质疑这种解释
- LF 反映交感神经和副交感神经的影响
- 上下文相关：受控呼吸影响心力衰竭

**高频功率：**
- 可靠的副交感神经指标
- 随休息、放松、深呼吸而增加
- 随压力、焦虑、交感神经激活而降低

**录音要求：**
- **最小值**：LF/HF 估计需要 60 秒
- **推荐**：短期 HRV 2-5 分钟
- **最佳**：根据工作组标准 5 分钟
- **长期**：24 小时进行 ULF 分析

## 非线性域分析

### HRV_非线性()

计算反映自主动态的复杂性、熵和分形度量。

```python
hrv_nonlinear = nk.hrv_nonlinear(peaks, sampling_rate=1000)
```

### 庞加莱图指数

**庞加莱图**：NN(i+1) 与 NN(i) 散点图几何

- `HRV_SD1`：垂直于同一线的标准偏差（毫秒）
  - 短期 HRV、快速逐搏变异
  - 反映副交感神经活动
  - 与 RMSSD 相关的数学：SD1 ≈ RMSSD/√2

- `HRV_SD2`：沿同一线的标准偏差（毫秒）
  - 长期HRV，缓慢变化
  - 反映交感神经和副交感神经活动
  - 与SDNN相关

- `HRV_SD1SD2`：比率 SD1/SD2
  - 短期和长期变化之间的平衡
  - <1：主要是长期变化

- `HRV_SD2SD1`：SD2/SD1 比率
  - SD1SD2 的逆

- `HRV_S`：椭圆面积 (π × SD1 × SD2)
  - 总 HRV 幅度

- `HRV_CSI`：心脏交感神经指数 (SD2/SD1)
  - 提议的同情指标

- `HRV_CVI`：心脏迷走神经指数 (log10(SD1 × SD2))
  - 提议的副交感神经指标

- `HRV_CSI_Modified`：修改后的 CSI (SD2²/(SD1 × SD2))

### 心率不对称

分析心率加速和减速对 HRV 的影响是否不同。

- `HRV_GI`：古兹克指数 - 短期波动的不对称性
- `HRV_SI`：斜率指数 - 长期变化的不对称性
- `HRV_AI`：面积索引 - 整体不对称
- `HRV_PI`：Porta 指数 - 减速百分比
- `HRV_C1d`、`HRV_C2d`：减速贡献
- `HRV_C1a`、`HRV_C2a`：加速贡献
- `HRV_SD1d`、`HRV_SD1a`：用于减速/加速的庞加莱 SD1
- `HRV_SD2d`、`HRV_SD2a`：用于减速/加速的庞加莱 SD2

**释义：**
- 健康个体：存在不对称（更多/更大的减速）
- 临床人群：减少不对称性
- 反映加速与减速的差异自主控制

### 熵测量

**近似熵 (ApEn)：**
- `HRV_ApEn`：规律性测量，较低=更规律/可预测
- 对数据长度、阶数 m、容差 r 敏感

**样本熵（SampEn）：**
- `HRV_SampEn`：改进的 ApEn，更少依赖数据长度
- 与短录音更一致
- 较低的值=更规则的模式

**多尺度熵 (MSE)：**
- `HRV_MSE`：跨多个时间尺度的复杂性
- 区分真正的复杂性和随机性

**模糊熵：**
- `HRV_FuzzyEn`：用于模式匹配的模糊隶属函数
- 短数据更稳定

**香农熵：**
- `HRV_ShanEn`：信息论随机性度量

### 分形度量

**去趋势波动分析 (DFA)：**
- `HRV_DFA_alpha1`：短期分形缩放指数（4-11 节拍）
- α1 > 1：相关性，心脏病时降低
  - α1 ≈ 1：粉红噪声，健康
  - α1 < 0.5：反相关

- `HRV_DFA_alpha2`：长期分形缩放指数（>11 次）
  - 反映长期相关性

- `HRV_DFA_alpha1alpha2`：比率 α1/α2

**相关维度：**
- `HRV_CorDim`：相空间中吸引子的维数
- 表示系统复杂性

**樋口分形维数：**
- `HRV_HFD`：复杂性和自相似性
- 数值越高=越复杂、越不规则

**彼得罗分形维数：**
- `HRV_PFD`：替代复杂性度量
- 计算效率高

**卡茨分形维数：**
- `HRV_KFD`：波形复杂度

### 心率碎片

量化反映自主神经失调的异常短期波动。

- `HRV_PIP`：拐点百分比
  - 正常：~50%，碎片：>70%
- `HRV_IALS`：加减速段平均长度的倒数
- `HRV_PSS`：短片段的百分比（<3 节拍）
- `HRV_PAS`：交替段中 NN 间隔的百分比

**临床相关性：**
- 与心血管风险相关的碎片化增加
- 超越传统 HRV 指标的独立预测器

### 其他非线性指标

- `HRV_Hurst`：赫斯特指数（长程依赖性）
- `HRV_LZC`：Lempel-Ziv 复杂度（算法复杂度）
- `HRV_MFDFA`：多重分形 DFA 索引

## 专门的 HRV 功能

### hrv_rsa()

呼吸性窦性心律失常——通过呼吸调节心率。

```python
rsa = nk.hrv_rsa(peaks, rsp_signal, sampling_rate=1000, method='porges1980')
```

**方法：**
- `'porges1980'`：Porges-Bohrer 方法（呼吸频率附近的带通滤波 HR）
- `'harrison2021'`：峰谷 RSA（每个呼吸周期的最大-最小心率）

**要求：**
- 心电图和呼吸信号
- 同步计时
- 至少几个呼吸周期

**退货：**
- `RSA`：RSA 幅度（节拍/分钟或类似单位，具体取决于方法）

### hrv_rqa()

递归量化分析 - 来自相空间重建的非线性动力学。

```python
rqa = nk.hrv_rqa(peaks, sampling_rate=1000)
```

**指标：**
- `RQA_RR`：重复率 - 系统可预测性
- `RQA_DET`：确定性 - 形成线的重复点的百分比
- `RQA_LMean`、`RQA_LMax`：平均和最大对角线长度
- `RQA_ENTR`：线长度的香农熵 - 复杂性
- `RQA_LAM`：层流 - 系统陷入特定状态
- `RQA_TT`：捕获时间 - 层流状态下的持续时间

**用例：**
- 检测生理状态的转变
- 评估系统决定论与随机性

## 间隔处理

###Intervals_process()

在 HRV 分析之前预处理 RR 间隔。

```python
processed_intervals = nk.intervals_process(rr_intervals, interpolate=False,
                                           interpolate_sampling_rate=1000)
```

**操作：**
- 消除生理上不合理的间隔
- 可选：插值到常规采样
- 可选：去趋势化以消除缓慢趋势

**用例：**
- 使用预先提取的 RR 间隔时
- 外部设备的清洁间隔
- 为频域分析准备数据

### Intervals_to_peaks()

将间隔数据（RR、NN）转换为 HRV 分析的峰值指数。

```python
peaks_dict = nk.intervals_to_peaks(rr_intervals, sampling_rate=1000)
```

**用例：**
- 从外部 HRV 设备导入数据
- 使用商业系统的间隔数据
- 区间和峰值表示之间的转换

## 实际考虑

### 最短录音时长

|分析|最短持续时间 |最佳持续时间 |
|----------|-----------------|------------------|
| RMSSD，pNN50 | 30 秒 | 5 分钟 |
| SDNN | 5 分钟 | 5 分钟（短），24 小时（长）|
|低频、高频功率 | 2 分钟 | 5 分钟 |
|甚低频功率| 5 分钟 | 10 分钟以上 |
|超低频电源| 24 小时 | 24 小时 |
|非线性（ApEn、SampEn）| 100-300 次 | 500+ 节拍 |
| DFA | 300 次 | 1000+ 节拍 |

### 工件管理

**预处理：**
```python
# Detect R-peaks with artifact correction
peaks, info = nk.ecg_peaks(cleaned_ecg, sampling_rate=1000, correct_artifacts=True)

# Or manually process intervals
processed = nk.intervals_process(rr_intervals, interpolate=False)
```

**质量检查：**
- 转速图的目视检查（NN 间隔随时间变化）
- 识别生理上不合理的间隔（<300 ms 或 >2000 ms）
- 检查是否突然跳跃或丢失节拍
- 分析前评估信号质量

### 标准化和比较

**工作组标准 (1996)：**
- 5分钟的短期录音
- 建议仰卧，控制呼吸
- 24小时长期评估

**标准化：**
- 考虑年龄、性别、健身水平的影响
- 一天中的时间和昼夜节律影响
- 身体姿势（仰卧与站立）
- 呼吸频率和深度
**个体间差异：**
- HRV 受试者间差异较大
- 受试者内部的变化更容易解释
- 首选基线比较

## 临床和研究应用

**心血管健康：**
- HRV 降低：心脏事件的危险因素
- SDNN、DFA alpha1：预后指标
- 心梗后监测

**心理状态：**
- 焦虑/压力：HRV 降低（特别是 RMSSD、HF）
- 抑郁症：自主神经平衡改变
- PTSD：碎片指数

**运动表现：**
- 通过每日 RMSSD 监控训练负荷
- 过度训练：HRV 降低
- 恢复评估

**神经科学：**
- 情绪调节研究
- 认知负荷评估
- 脑心轴研究

**老化：**
- HRV 随着年龄的增长而降低
- 复杂性指标下降
- 需要基线参考

## 参考文献

- 欧洲心脏病学会工作组。 （1996）。心率变异性：测量标准、生理解释和临床应用。流通，93（5），1043-1065。
- Shaffer, F. 和 Ginsberg, J. P. (2017)。心率变异性指标和规范概述。公共卫生前沿，5, 258。
- Peng, C.K.、Havlin, S.、Stanley, H.E. 和 Goldberger, A.L. (1995)。非平稳心跳时间序列中缩放指数和交叉现象的量化。混沌，5(1)，82-87。
- Guzik, P.、Piskorski, J.、Krauze, T.、Wykretowicz, A. 和 Wysocki, H. (2006)。 RR 间隔庞加莱图的心率不对称性。生物医学技术/生物医学工程，51(4), 272-275。
- Costa, M.、Goldberger, A. L. 和 Peng, C. K. (2005)。生物信号的多尺度熵分析。物理评论 E，71(2)，021906。