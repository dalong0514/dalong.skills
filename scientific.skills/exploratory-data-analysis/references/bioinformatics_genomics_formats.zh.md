<!-- 此文件由机器翻译自 bioinformatics_genomics_formats.md -->

# 生物信息学和基因组学文件格式参考

该参考文献涵盖了基因组学、转录组学、序列分析和相关生物信息学应用中使用的文件格式。

## 序列数据格式

### .fasta / .fa / .fna - FASTA 格式
**描述：** 基于文本的核苷酸或蛋白质序列格式
**典型数据：** 带标题的 DNA、RNA 或蛋白质序列
**用例：** 序列存储、BLAST 搜索、比对
**Python 库：**
- `Biopython`：`SeqIO.parse('file.fasta', 'fasta')`
- `pyfaidx`：快速索引 FASTA 访问
- `screed`：快速序列解析
**EDA 方法：**
- 序列计数和长度分布
- GC含量分析
- N内容（不明确的碱基）
- 序列ID解析
- 重复检测
- 装配质量指标（N50、L50）

### .fastq / .fq - FASTQ 格式
**描述：** 具有碱基质量分数的序列数据
**典型数据：** 带有 Phred 质量分数的原始测序读数
**用例：** NGS 数据、质量控制、读取图谱
**Python 库：**
- `Biopython`：`SeqIO.parse('file.fastq', 'fastq')`
- `pysam`：快速 FASTQ/BAM 操作
- `HTSeq`：测序数据分析
**EDA 方法：**
- 读取计数和长度分布
- 质量分数分布（每个碱基、每次读取）
- GC含量和偏差
- 重复率估计
- 适配器污染检测
- k聚体频率分析
- 编码格式验证（Phred33/64）

### .sam - 序列比对/图谱
**描述：** 用于对齐的制表符分隔文本格式
**典型数据：** 具有比对质量的比对测序读数
**用例：** 读取比对存储、变体调用
**Python 库：**
- `pysam`: `pysam.AlignmentFile('file.sam', 'r')`
- `HTSeq`：`HTSeq.SAM_Reader('file.sam')`
**EDA 方法：**
- 映射率和质量分布
- 覆盖率分析
- 插入物尺寸分布（双端）
- 对齐标志分布
- 雪茄串图案
- 错配和插入缺失率
- 重复和补充对齐计数

### .bam - 二进制对齐/映射
**描述：** SAM 的压缩二进制版本
**典型数据：** 压缩格式的对齐读取
**用例：** 对齐的高效存储和处理
**Python 库：**
- `pysam`：带索引的完整 BAM 支持
- `bamnostic`：纯Python BAM阅读器
**EDA 方法：**
- 与 SAM plus 相同：
- 压缩比分析
- 索引文件（.bai）验证
- 染色体统计
- 链偏差检测
- 阅读小组分析

### .cram - CRAM 格式
**描述：** 高度压缩的对齐格式
**典型数据：**参考压缩对齐读数
**用例：** 长期存储、节省空间的档案
**Python 库：**
- `pysam`：CRAM 支持（需要参考）
- 参考基因组必须可访问
**EDA 方法：**
- 压缩效率与 BAM
- 参考依赖验证
- 有损与无损压缩评估
- 减压性能
- 与 BAM 类似的对齐指标

### .bed - 浏览器可扩展数据
**描述：** 基因组特征的制表符分隔格式
**典型数据：** 带注释的基因组间隔（chr、开始、结束）
**用例：** 峰检出、变异注释、基因组浏览
**Python 库：**
- `pybedtools`：`pybedtools.BedTool('file.bed')`
- `pyranges`：`pyranges.read_bed('file.bed')`
- `pandas`：简单的 BED 读取
**EDA 方法：**
- 特征数量和尺寸分布
- 染色体分布
- 链偏向
- 分数分布（如果存在）
- 重叠和邻近分析
- 覆盖率统计
- 特征之间的差距分析

### .bedGraph - 带有图形数据的 BED
**描述：** BED 格式，包含每个碱基的信号值
**典型数据：** 连续值基因组数据（覆盖范围、信号）
**用例：** 覆盖轨迹、ChIP-seq 信号、甲基化
**Python 库：**
- `pyBigWig`：可以转换为bigWig
- `pybedtools`：BedGraph 操作
**EDA 方法：**
- 信号分布统计
- 基因组覆盖率
- 信号动态（峰值、谷值）
- 染色体信号模式
- 分位数分析
- 零覆盖区域

### .bigWig / .bw - 二进制 BigWig
**描述：** 全基因组信号数据的索引二进制格式
**典型数据：**连续基因组信号（压缩和索引）
**使用案例：**高效的基因组浏览器轨迹、大规模数据
**Python 库：**
- `pyBigWig`：`pyBigWig.open('file.bw')`
- `pybbi`：BigWig/BigBed 接口
**EDA 方法：**
- 信号统计提取
- 缩放级别分析
- 区域信号提取
- 高效的全基因组摘要
- 压缩效率
- 指数结构分析

### .bigBed / .bb - 二进制 BigBed
**描述：** 索引二进制 BED 格式
**典型数据：** 基因组特征（压缩和索引）
**用例：** 大型功能集、基因组浏览器
**Python 库：**
- `pybbi`：BigBed 读取
- `pybigtools`：现代 BigBed 界面
**EDA 方法：**
- 特征密度分析
- 高效的区间查询
- 缩放级别验证
- 指数绩效指标
- 特征尺寸统计

### .gff / .gff3 - 通用特征格式
**描述：** 用于基因组注释的制表符分隔格式
**典型数据：** 基因模型、转录本、外显子、调控元件
**用例：** 基因组注释、基因预测
**Python 库：**
- `BCBio.GFF`：Biopython GFF 模块
- `gffutils`：`gffutils.create_db('file.gff3')`
- `pyranges`：GFF 支持
**EDA 方法：**
- 特征类型分布（基因、外显子、CDS等）
- 基因结构验证
- 股线平衡
- 层次关系验证
- CDS 的阶段验证
- 属性完整性
- 基因模型统计（每个基因的内含子、外显子）

### .gtf - 基因转移格式
**描述：** 基于 GFF2 的基因注释格式
**典型数据：** 基因和转录本注释
**用例：** RNA-seq 分析、基因定量
**Python 库：**
- `pyranges`：`pyranges.read_gtf('file.gtf')`
- `gffutils`：GTF 数据库创建
- `HTSeq`：GTF 读取计数
**EDA 方法：**
- 转录本亚型分析
- 基因结构完整性
- 外显子数量分布
- 转录本长度分布
- TSS和TES分析
- 生物型分布
- 重叠基因检测

### .vcf - 变体调用格式
**描述：** 遗传变异的文本格式
**典型数据：** SNP、插入缺失、带注释的结构变异
**用例：** 变异调用、群体遗传学、GWAS
**Python 库：**
- `pysam`：`pysam.VariantFile('file.vcf')`
- `cyvcf2`：快速 VCF 解析
- `PyVCF`：较旧但全面
**EDA 方法：**
- 按类型分类的变异计数（SNP、indel、SV）
- 质量分数分布
- 等位基因频谱
- 过渡/转换比
- 杂合率
- 缺失基因型分析
- 哈代-温伯格平衡
- 注释完整性（如果有注释）

### .bcf - 二进制 VCF
**描述：** 压缩二进制变体格式
**典型数据：** 与 VCF 相同，但为二进制
**用例：** 高效的变体存储和处理
**Python 库：**
- `pysam`：完整的 BCF 支持
- `cyvcf2`：优化BCF读取
**EDA 方法：**
- 与 VCF 相同，加上：
- 压缩效率
- 索引验证
- 读取性能指标

### .gvcf - 基因组 VCF
**描述：**带有参考置信块的VCF
**典型数据：** 所有位置（变异和非变异）
**用例：** 联合基因分型工作流程、GATK
**Python 库：**
- `pysam`：GVCF 支持
- 标准VCF解析器
**EDA 方法：**
- 参考块分析
- 覆盖均匀性
- 变异密度
- 整个基因组的基因型质量
- 参考置信度分布

## RNA-Seq 和表达数据

### .counts - 基因计数矩阵
**描述：** 制表符分隔的基因表达计数
**典型数据：** 基因 ID 以及每个样本的读取计数
**用例：** RNA-seq 定量、差异表达
**Python 库：**
- `pandas`：`pd.read_csv('file.counts', sep='\t')`
- `scanpy`（对于单单元格）：`sc.read_csv()`
**EDA 方法：**
- 文库大小分布
- 检测率（每个样本的基因）
- 零通胀分析
- 计数分布（对数刻度）
- 异常样本检测
- 重复之间的相关性
- 用于样本关系的 PCA

### .tpm / .fpkm - 标准化表达式
**描述：**标准化基因表达值
**典型数据：** TPM（每百万份转录本）或 FPKM 值
**用例：** 跨样本比较、可视化
**Python 库：**
- `pandas`：标准 CSV 读取
- `anndata`：用于集成分析
**EDA 方法：**
- 表达分布
- 高表达基因鉴定
- 样本聚类
- 批量效果检测
- 变异系数分析
- 动态范围评估

### .mtx - 矩阵市场格式
**说明：** 稀疏矩阵格式（单细胞中常见）
**典型数据：** 稀疏计数矩阵（细胞×基因）
**用例：** 单细胞 RNA-seq、大型稀疏矩阵
**Python 库：**
- `scipy.io`：`scipy.io.mmread('file.mtx')`
- `scanpy`：`sc.read_mtx('file.mtx')`
**EDA 方法：**
- 稀疏性分析
- 细胞和基因过滤阈值
- 双峰检测指标
- 线粒体分数
- UMI计数分布
- 每个细胞的基因检测

### .h5ad - Anndata 格式
**描述：** 基于HDF5的注释数据矩阵
**典型数据：** 具有元数据（细胞、基因）的表达矩阵
**用例：** 使用 Scanpy 进行单细胞 RNA 序列分析
**Python 库：**
- `scanpy`：`sc.read_h5ad('file.h5ad')`
- `anndata`：直接 AnnData 操作
**EDA 方法：**
- 细胞和基因计数
- 元数据完整性
- 层可用性（原始、标准化）
- 嵌入存在（PCA、UMAP）
- QC指标分布
- 批次信息
- 细胞类型注释覆盖范围

### .loom - Loom 格式
**描述：** 基于 HDF5 的组学数据格式
**典型数据：** 带有元数据的表达矩阵
**用例：** 单细胞数据、RNA 速度分析
**Python 库：**
- `loompy`：`loompy.connect('file.loom')`
- `scanpy`: 可以导入 loom 文件
**EDA 方法：**
- 层分析（拼接、未拼接）
- 行和列属性探索
- 图连通性分析
- 集群分配
- 特定于速度的指标

### .rds - R 数据序列化
**描述：** R 对象存储（通常是 Seurat 对象）
**典型数据：** R分析结果，尤其是单细胞
**用例：** R-Python 数据交换
**Python 库：**
- `pyreadr`：`pyreadr.read_r('file.rds')`
- `rpy2`：用于完整的 R 集成
- AnnData 转换工具
**EDA 方法：**
- 对象类型识别
- 数据结构探索
- 元数据提取
- 转换验证

## 对齐和汇编格式

### .maf - 多重对齐格式
**描述：** 用于多序列比对的文本格式
**典型数据：** 全基因组或局部多重比对
**用例：** 比较基因组学、保守分析
**Python 库：**
- `Biopython`：`AlignIO.parse('file.maf', 'maf')`
- `bx-python`：MAF 特定工具
**EDA 方法：**
- 对齐块统计
- 物种覆盖范围
- 差距分析
- 保护评分
- 对齐质量指标
- 块长度分布

### .axt - 成对对齐格式
**描述：** 成对比对格式 (UCSC)
**典型数据：** 成对基因组比对
**用例：** 基因组比较、同线性分析
**Python 库：**
- 自定义解析器（简单格式）
- `bx-python`：AXT 支持
**EDA 方法：**
- 对齐分数分布
- 身份百分比
- 同线块识别
- 间隙尺寸分析
- 覆盖率统计

### .chain - 链对齐格式
**描述：** 基因组坐标图谱链
**典型数据：** 基因组构建之间的坐标转换
**用例：** 举升、坐标转换
**Python 库：**
- `pyliftover`：链文件使用
- 链格式的自定义解析器
**EDA 方法：**
- 连锁分数分布
- 源基因组的覆盖范围
- 差距分析
- 反转检测
- 测绘质量评估

### .psl - 模式空间布局
**说明：** BLAT/BLAST 比对格式
**典型数据：** BLAT 的比对结果
**用例：** 转录本映射、相似性搜索
**Python 库：**
- 自定义解析器（制表符分隔）
- `pybedtools`：可以处理 PSL
**EDA 方法：**
- 匹配百分比分布
- 差距统计
- 查询覆盖率
- 多重映射分析
- 对齐质量指标

## 基因组组装和注释

### .agp - 装配黄金路径
**描述：**装配结构说明
**典型数据：** 支架组成、间隙信息
**用例：** 基因组组装表示
**Python 库：**
- 自定义解析器（简单的制表符分隔）
- 装配分析工具
**EDA 方法：**
- 脚手架统计（N50、L50）
- 间隙类型和尺寸分布
- 元件长度分析
- 装配连续性指标
- 未定位的重叠群分析

### .scaffolds / .contigs - 组装序列
**描述：** 组装序列（通常为FASTA）
**典型数据：** 组装的基因组序列
**用例：** 基因组组装输出
**Python 库：**
- 与FASTA格式相同
- 装配专用工具 (QUAST)
**EDA 方法：**
- 装配统计（N50、N90等）
- 长度分布
- 覆盖率分析
- 间隙（N）含量
- 重复评估
- BUSCO 完整性（如果注释可用）

### .2bit - 压缩基因组格式
**描述：** UCSC 紧凑基因组格式
**典型数据：** 参考基因组（高度压缩）
**用例：**高效的基因组存储和访问
**Python 库：**
- `py2bit`：`py2bit.open('file.2bit')`
- `twobitreader`：替代阅读器
**EDA 方法：**
- 压缩效率
- 随机存取性能
- 序列提取验证
- 屏蔽区域分析
- N内容和分布

### .sizes - 染色体大小
**描述：** 带有染色体长度的简单格式
**典型数据：** 制表符分隔的染色体名称和大小
**用例：** 基因组浏览器、坐标验证
**Python 库：**
- 使用 pandas 进行简单的文件读取
- 内置于许多基因组工具中
**EDA 方法：**
- 基因组大小计算
- 染色体计数
- 尺寸分布
- 核型验证
- 对照参考进行完整性检查

## 系统发育和进化

### .nwk / .newick - Newick 树格式
**描述：** 括号树表示
**典型数据：** 具有分支长度的系统发育树
**用例：** 进化分析、树可视化
**Python 库：**
- `Biopython`：`Phylo.read('file.nwk', 'newick')`
- `ete3`：`ete3.Tree('file.nwk')`
- `dendropy`：系统发育计算
**EDA 方法：**
- 树结构分析（提示、内部节点）
- 分支长度分布
- 树平衡指标
- 超量度检查
- Bootstrap支持分析
- 拓扑验证

### .nexus - Nexus 格式
**描述：** 系统发育数据的丰富格式
**典型数据：** 对齐、树、字符矩阵
**用例：** 系统发育软件交换
**Python 库：**
- `Biopython`：Nexus 支持
- `dendropy`：全面的 Nexus 处理
**EDA 方法：**
- 数据块分析
- 人物类型分布
- 树块验证
- 类群一致性
- 命令块解析
- 格式合规性检查

### .phylip - PHYLIP 格式
**说明：** 序列比对格式（严格/宽松）
**典型数据：** 多序列比对
**用例：** 系统发育分析输入
**Python 库：**
- `Biopython`：`AlignIO.read('file.phy', 'phylip')`
- `dendropy`：PHYLIP 支持
**EDA 方法：**
- 对齐尺寸
- 序列长度均匀性
- 缺口位置分析
- 信息丰富的站点计算
- 格式变异检测（严格与宽松）

### .paml - PAML 输出
**描述：** PAML 系统发育软件的输出
**典型数据：** 进化模型结果，dN/dS 比率
**用例：** 分子进化分析
**Python 库：**
- 针对特定 PAML 程序的自定义解析器
- `Biopython`：基本 PAML 解析
**EDA 方法：**
- 模型参数提取
- 似然值
- dN/dS 比率分布
- 分行特定结果
- 收敛性评估

## 蛋白质和结构数据

### .embl - EMBL 格式
**说明：**丰富的序列注释格式
**典型数据：** 带有大量注释的序列
**用例：** 序列数据库、基因组记录
**Python 库：**
- `Biopython`：`SeqIO.read('file.embl', 'embl')`
**EDA 方法：**
- 特征注释完整性
- 序列长度和类型
- 参考信息
- 交叉引用验证
- 特征重叠分析

### .genbank / .gb / .gbk - GenBank 格式
**说明：** NCBI的序列注释格式
**典型数据：** 带特征的注释序列
**用例：** 序列数据库、注释传输
**Python 库：**
- `Biopython`：`SeqIO.parse('file.gb', 'genbank')`
**EDA 方法：**
- 特征类型分布
- CDS分析（起始密码子、终止密码子）
- 翻译验证
- 注释完整性
- 源生物提取
- 参考和出版信息
- 基因座标签一致性

### .sff - 标准流程图格式
**说明：** 454/Roche 测序数据格式
**典型数据：** 原始焦磷酸测序流程图
**使用案例：** 传统 454 测序数据
**Python 库：**
- `Biopython`：`SeqIO.parse('file.sff', 'sff')`
- 特定于平台的工具
**EDA 方法：**
- 读取次数和长度
- 信号质量流程图
- 按键序列检测
- 适配器修剪验证
- 质量分数分布

### .hdf5（基因组特定）
**描述：** 用于基因组学的 HDF5（10X、Hi-C 等）
**典型数据：** 高通量基因组数据
**用例：** 10X 基因组学、空间转录组学
**Python 库：**
- `h5py`：低级访问
- `scanpy`：对于 10X 数据
- `cooler`：适用于 Hi-C 数据
**EDA 方法：**
- 数据集结构探索
- 条码统计
- UMI计数
- 特征条形码矩阵分析
- 空间坐标（如果适用）

### .cool / .mcool - 冷却器格式
**描述：** 基于HDF5的Hi-C接触矩阵
**典型数据：** 染色质相互作用矩阵
**用例：** 3D 基因组分析、Hi-C 数据
**Python 库：**
- `cooler`：`cooler.Cooler('file.cool')`
- `hicstraw`：适用于 .hic 格式
**EDA 方法：**
- 分辨率分析
- 联系矩阵统计
- 距离衰减曲线
- 车厢分析
- TAD边界检测
- 平衡因素验证

### .hic - Hi-C 二进制格式
**描述：** 榨汁机二进制 Hi-C 格式
**典型数据：** 多分辨率 Hi-C 矩阵
**用例：** 使用 Juicer 工具进行 Hi-C 分析
**Python 库：**
- `hicstraw`：`hicstraw.HiCFile('file.hic')`
- `straw`：具有 Python 绑定的 C++ 库
**EDA 方法：**
- 可用分辨率
- 标准化方法
- 联系统计
- 染色体相互作用
- 质量指标

### .bw（ChIP-seq/ATAC-seq 特定）
**描述：** 用于表观基因组学的 BigWig 文件
**典型数据：** 覆盖或富集信号
**用例：** ChIP-seq、ATAC-seq、DNase-seq
**Python 库：**
- `pyBigWig`：标准 bigWig 访问
**EDA 方法：**
- 峰富集模式
- 背景信号分析
- 样本相关性
- 信噪比
- 库复杂性指标

### .narrowPeak / .broadPeak - 编码峰值格式
**描述：** 基于 BED 的峰格式
**典型数据：** 带有分数和 p 值的峰值调用
**用例：** ChIP-seq 峰值检出输出
**Python 库：**
- `pybedtools`：BED 兼容
- 针对特定峰值字段的自定义解析器
**EDA 方法：**
- 峰数和宽度分布
- 信号值分布
- Q值和p值分析
- 峰顶分析
- 与已知功能重叠
- 基序富集准备

### .wig - Wiggle 格式
**描述：** 密集连续基因组数据
**典型数据：** 覆盖范围或信号轨道
**用例：** 基因组浏览器可视化
**Python 库：**
- `pyBigWig`：可以转换为bigWig
- 用于摆动格式的自定义解析器
**EDA 方法：**
- 信号统计
- 覆盖率指标
- 格式变体（fixedStep 与variableStep）
- 跨度参数分析
- 转换效率为bigWig

### .ab1 - 桑格测序追踪
**描述：** 二元色谱图格式
**典型数据：** Sanger 测序痕迹
**用例：** 毛细管测序验证
**Python 库：**
- `Biopython`：`SeqIO.read('file.ab1', 'abi')`
- `tracy` 工具：用于质量评估
**EDA 方法：**
- 碱基检出质量
- 跟踪质量分数
- 混合碱基检测
- 引物和载体检测
- 阅读长度和质量区域
- 杂合性检测

### .scf - 标准色谱图格式
**描述：**桑格测序色谱图
**典型数据：** 碱基检出和置信值
**用例：** 测序痕迹分析
**Python 库：**
- `Biopython`：SCF 格式支持
**EDA 方法：**
- 类似于AB1格式
- 质量得分档案
- 峰高比
- 信噪比指标

### .idx - 索引文件（通用）
**说明：**各种格式的索引文件
**典型数据：** 快速随机访问索引
**用例：** 高效的数据访问（BAM、VCF 等）
**Python 库：**
- 特定于格式的库处理索引
- `pysam`：自动处理 BAI、CSI 指数
**EDA 方法：**
- 索引完整性验证
- 分箱策略分析
- 访问性能指标
- 索引大小与数据大小之比