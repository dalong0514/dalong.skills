<!-- 此文件由机器翻译自 confidence_and_limitations.md -->

# DiffDock 置信度分数和局限性

本文档提供了有关解释 DiffDock 置信度分数和了解该工具的局限性的详细指导。

## 置信度分数解释

DiffDock 为每个预测的结合姿势生成置信度得分。该分数表明模型对预测的确定性。

### 分数范围

|分数范围|置信度 |解读|
|------------------------|--------------------------------|----------------|
| **> 0** |高信心|强有力的预测，可能准确的结合姿势 |
| **-1.5 至 0** |中等信心|合理预测，可能需要验证|
| **< -1.5** |低信心|预测不确定，需要仔细验证|

### 关于置信度分数的重要说明

1. **非结合亲和力**：置信度分数反映预测的确定性，而不是结合亲和力强度
   - 高置信度=模型对结构有信心
   - 不表示结合亲和力强/弱

2. **上下文相关**：应根据系统复杂性调整置信度分数：
   - **降低期望**：
     - 大配体 (>500 Da)
     - 具有许多链的蛋白质复合物
     - 未结合的蛋白质构象（可能需要构象变化）
     - 新的蛋白质家族在训练数据中没有得到很好的体现

   - **更高的期望**：
     - 药物样小分子（150-500 Da）
     - 单链蛋白质或明确的结合位点
     - 与训练数据中相似的蛋白质（PDBBind、BindingMOAD）

3. **多重预测**：DiffDock 为每个复合体生成多个样本（默认值：10）
   - 查看排名最高的预测（按置信度）
   - 考虑对相似的姿势进行聚类
   - 多个样本的高置信度共识加强了预测

## DiffDock 的预测

### ✅ DiffDock 确实可以预测
- **结合姿势**：蛋白质结合位点中配体的 3D 空间方向
- **置信度分数**：模型对预测的确定性
- **多种构象**：各种可能的结合模式

### ❌ DiffDock 不预测
- **结合亲和力**：蛋白质-配体相互作用的强度（ΔG、Kd、Ki）
- **结合动力学**：开/关速率、停留时间
- **ADMET 特性**：吸收、分布、代谢、排泄、毒性
- **选择性**：与不同目标的相对结合

## 范围和限制

### 专为
- **小分子对接**：有机化合物通常为 100-1000 Da
- **蛋白质目标**：单链或多链蛋白质
- **小肽**：短肽配体（< ~20 个残基）
- **小核酸**：短寡核苷酸

### 不适合
- **大生物分子**：完整的蛋白质-蛋白质相互作用
  - 使用 DiffDock-PP、AlphaFold-Multimer 或 RoseTTAFold2NA 代替
- **大肽/蛋白质**：>20 个残基作为配体
- **共价对接**：不可逆共价键形成
- **金属蛋白细节**：可能无法准确处理金属配位
- **膜蛋白**：未针对膜嵌入蛋白进行专门训练

### 训练数据注意事项

DiffDock 接受过以下方面的培训：
- **PDBBind**：多种蛋白质-配体复合物
- **BindingMOAD**：多结构域蛋白质结构

**影响**：
- 与训练数据类似的蛋白质/配体的最佳性能
- 可能在以下方面表现不佳：
  - 新型蛋白质家族
  - 不寻常的配体化学型
  - 变构位点在训练数据中没有得到很好的体现

## 验证和补充工具

### 推荐工作流程

1. **使用 DiffDock 生成姿势**
   - 使用置信度分数进行初始排名
   - 考虑多个高置信度预测

2. **目视检查**
   - 在分子查看器中检查蛋白质-配体相互作用
   - 检查是否合理：
     - 氢键
     - 疏水相互作用
     - 空间互补性
     - 静电相互作用

3. **评分和细化**（选择一项或多项）：
   - **GNINA**：基于深度学习的评分功能
   - **分子力学**：能量最小化和细化
   - **MM/GBSA 或 MM/PBSA**：结合自由能估计
   - **自由能计算**：FEP 或 TI 用于准确的亲和力预测

4. **实验验证**
   - 生化测定（IC50、Kd 测量）
   - 结构验证（X 射线晶体学、冷冻电镜）

### 结合亲和力评估工具

DiffDock 应与以下工具结合进行亲和力预测：

- **GNINA**：快速、准确的评分功能
- Github：github.com/gnina/gnina

- **AutoDock Vina**：经典对接和评分
  - 网站：vina.scripps.edu

- **自由能量计算**：
  - OpenMM + OpenFE
  - GROMACS + ABFE/RBFE 协议

- **MM/GBSA 工具**：
  - MMPBSA.py (AmberTools)
  - gmx_MMPBSA

## 性能优化

### 为了获得最佳效果

1. **蛋白质制备**：
   - 去除远离结合位点的水分子
   - 如果可能的话，解决缺失的残留物
   - 考虑生理pH值下的质子化状态

2. **配体输入**：
   - 使用结构文件时提供合理的 3D 构象
   - 使用规范的 SMILES 以获得一致的结果
   - 如果需要，使用 RDKit 进行预处理

3. **计算资源**：
   - 强烈推荐使用 GPU（加速 10-100 倍）
   - 首次运行预计算查找表（需要几分钟）
   - 批处理比单个预测更高效

4. **参数调整**：
   - 对于困难的情况增加`samples_per_complex` (20-40)
   - 调整温度参数以实现多样性/准确性权衡
   - 使用预先计算的 ESM 嵌入进行重复预测

## 常见问题和故障排除

### 低置信度分数
- **大/灵活的配体**：考虑分成片段或使用替代方法
- **多个结合位点**：可以以分布式置信度预测多个位置
- **蛋白质灵活性**：考虑使用蛋白质构象的集合

### 不切实际的预测
- **冲突**：可能表明需要蛋白质制备或精炼
- **表面结合**：检查真正的结合位点是否被封锁或不清楚
- **不寻常的姿势**：考虑增加样本以探索更多构象

### 性能缓慢
- **使用 GPU**：对于合理的运行时间至关重要
- **预计算嵌入**：对相同蛋白质重复使用 ESM 嵌入
- **批处理**：比顺序单独预测更有效
- **减少样本**：降低`samples_per_complex`以进行快速筛选

## 引文和延伸阅读

有关方法详细信息和基准测试结果，请参阅：

1. **原始 DiffDock 论文** (ICLR 2023)：
   - “DiffDock：分子对接的扩散步骤、扭曲和转弯”
   - Corso 等人，arXiv：2210.01776

2. **DiffDock-L 论文** (2024)：
   - 增强模型，提高泛化能力
   - Stärk 等人，arXiv:2402.18396

3. **PoseBusters 基准**：
   - 严谨的对接评估框架
   - 用于 DiffDock 验证