<!-- 此文件由机器翻译自 protein_modeling.md -->

# 蛋白质建模

## 概述

TorchDrug 为蛋白质相关任务提供广泛的支持，包括序列分析、结构预测、属性预测和蛋白质-蛋白质相互作用。蛋白质以图表的形式表示，其中节点是氨基酸残基，边缘表示空间或顺序关系。

## 可用数据集

### 蛋白质功能预测

**酶的功能：**
- **酶委员会**（17,562 种蛋白质）：EC 编号分类（7 个级别）
- **β内酰胺酶**（5,864 个序列）：酶活性预测

**蛋白质特性：**
- **荧光**（54,025 个序列）：GFP 荧光强度
- **稳定性**（53,614 个序列）：热稳定性预测
- **溶解度**（62,478 个序列）：蛋白质溶解度分类
- **二元定位**（22,168 个蛋白质）：亚细胞定位（膜与可溶）
- **亚细胞定位**（8,943 个蛋白质）：10 类定位预测

**基因本体论：**
- **GeneOntology**（46,796 个蛋白质）：跨生物过程、分子功能和细胞成分的 GO 术语预测

### 蛋白质结构预测

- **折叠**（16,712 个蛋白质）：结构折叠分类（1,195 类）
- **二级结构**（8,678 个蛋白质）：3 态或 8 态二级结构预测
- **ContactPrediction** 通过 ProteinNet：残留物-残留物接触图

### 蛋白质相互作用

**蛋白质-蛋白质相互作用：**
- **HumanPPI**（1,412 个蛋白质，6,584 个相互作用）：人类蛋白质相互作用网络
- **YeastPPI**（2,018 个蛋白质，6,451 个相互作用）：酵母蛋白质相互作用网络
- **PPIAffinity**（2,156 个蛋白质对）：结合亲和力测量

**蛋白质-配体结合：**
- **BindingDB**（约 150 万条条目）：综合结合亲和力数据库
- **PDBBind**（20,000 多个复合物）：基于 3D 结构的结合数据
  - 精致套装：高品质晶体结构
  - 核心集：多样化的基准集

### 大规模蛋白质数据库

- **AlphaFoldDB**：访问 200M+ 预测的蛋白质结构
- **ProteinNet**：用于结构预测的标准化数据集

## 任务类型

### NodePropertyPrediction

预测残基（节点）级别的属性，例如二级结构或接触图。

**使用案例：**
- 二级结构预测（螺旋、片状、线圈）
- 残留水平无序预测
- 翻译后修饰位点
- 结合位点预测

### 属性预测

预测蛋白质水平的特性，如功能、稳定性或定位。

**使用案例：**
- 酶功能分类
- 亚细胞定位
- 蛋白质稳定性预测
- 基因本体术语预测

### 交互预测

预测蛋白质对或蛋白质-配体对之间的相互作用。

**主要特点：**
- 处理序列和结构输入
- 支持对称（PPI）和不对称（蛋白质-配体）相互作用
- 多种负采样策略

### 联系预测

用于预测折叠结构中残基之间的空间接近度的专门任务。

**应用：**
- 根据序列进行结构预测
- 蛋白质折叠途径分析
- 预测结构的验证

## 蛋白质表示模型

### 基于序列的模型

**ESM（进化尺度模型）：**
- 250M 序列上的预训练 Transformer 模型
- 最先进的仅序列任务
- 有多种尺寸可供选择（ESM-1b、ESM-2）
- 捕获进化和结构信息

**蛋白质BERT：**
- BERT风格的屏蔽语言模型
- 在 UniProt 序列上进行预训练
- 适合迁移学习

**蛋白质LSTM：**
- 用于序列编码的双向 LSTM
- 轻量且快速
- 序列任务的良好基线

**ProteinCNN / ProteinResNet：**
- 卷积架构
- 捕获本地序列模式
- 比变压器模型更快

### 基于结构的模型

**GearNet（几何感知关系图网络）：**
- 包含 3D 几何信息
- 基于顺序、半径和 K 最近邻的边类型
- 最先进的基于结构的任务
- 支持主干和全原子表示

**蛋白质图上的 GCN/GAT/GIN：**
- 适用于蛋白质的标准 GNN 架构
- 灵活的边缘定义（序列、空间、接触）

**施网：**
- 连续滤波器卷积
- 直接处理3D坐标
- 有利于结构预测和蛋白质-配体结合

### 基于特征的模型

**统计特征：**
- 氨基酸组成
- 序列长度统计
- 主题很重要

**理化特性：**
- 疏水性尺度
- 电荷特性
- 二级结构倾向
- 分子量，等电点

## 蛋白质图构建

### 边类型

**连续边缘：**
- 按顺序连接相邻的残基
- 捕获主要结构

**空间边缘：**
- 3D空间中的K最近邻
- 半径截止（例如，10Å 内的 Cα 原子）
- 捕获三级结构

**接触边缘：**
- 基于重原子距离
- 通常 < 8Å 阈值

### 节点特性

**残留物特性：**
- 20个氨基酸的One-hot编码
- 学习嵌入

**职位信息：**
- 3D 坐标（Cα、N、C、O）
- 骨干角度（phi、psi、omega）
- 相对空间位置编码

**理化性质：**
- 疏水性
- 充电
- 尺寸
- 二级结构

## 培训工作流程

### 预训练策略

**自我监督预训练：**
- 屏蔽残差预测（如 BERT）
- 残基之间的距离预测
- 角度预测（phi、psi、omega）
- 二面角预测
- 联系地图预测

**预训练模型用法：**
```python
from torchdrug import models

# Load pre-trained ESM
model = models.ESM(path="esm1b_t33_650M_UR50S.pt")

# Fine-tune on downstream task
task = tasks.PropertyPrediction(
    model, task=["stability"],
    criterion="mse", metric=["mae", "rmse"]
)
```

### 多任务学习

同时训练多项相关任务：
- 功能、定位和稳定性的联合预测
- 提高泛化能力和数据效率
- 跨任务共享表示

### 最佳实践

**对于仅序列任务：**
1. 从预训练的 ESM 或 ProteinBERT 开始
2. 小学习率微调（1e-5 到 1e-4）
3. 对小数据集使用冻结嵌入
4.应用dropout进行正则化

**对于基于结构的任务：**
1. 使用具有多种边缘类型的 GearNet
2. 包括几何特征（角度、二面角）
3.大型结构数据库的预训练
4. 使用数据增强（轮换、裁剪）

**对于小数据集：**
1. 从预训练模型进行迁移学习
2. 具有相关任务的多任务学习
3. 数据增强（序列突变、结构扰动）
4.强正则化（dropout、权重衰减）

## 常见用例

### 酶工程
- 根据序列预测酶活性
- 设计突变以提高稳定性
- 筛选所需的催化特性

### 抗体设计
- 预测结合亲和力
- 优化抗体序列
- 预测免疫原性

### 药物靶标识别
- 预测蛋白质功能
- 识别可药物位点
- 分析蛋白质-配体相互作用

### 蛋白质结构预测
- 根据序列预测二级结构
- 生成三级结构的接触图
- 完善 AlphaFold 预测

## 与其他工具集成

### AlphaFold 集成

加载 AlphaFold 预测的结构：
<<<代码块_1>>>

### ESMFold 集成

使用 ESMFold 进行结构预测，然后使用 TorchDrug 模型进行分析。

### 罗塞塔/PyRosetta

使用 Rosetta 生成结构，导入 TorchDrug 进行分析。